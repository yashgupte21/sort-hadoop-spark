# sort-hadoop-spark
Sort on Hadoop, Spark, Gensort, Shared Memory sort and Linux-sort.


We have implemented the following experiments on 1small, 1large and 6small instances for 1gb,4gb and 16gb files

--- Hadoop Sort HadoopSort.java ---

Hadoop cluster is inside /exports/projects/hadoop-3.2.2/ folder of the instances
Input file is generated by gensort utility(Steps for gensort are given below in the readme file)
We create input directory inside HDFS using this command :
	
	bin/hadoop fs -mkdir /home
	
	bin/hadoop fs -mkdir /home/input
	
This generated input data is copied inside HDFS

	bin/hadoop fs -put [INPUT_FILENAME_GENSORT] /home/input

Once we've our input in place we will run the following commands sequentially,

	export HADOOP_CLASSPATH=$JAVA_HOME/lib/tools.jar

	bin/hadoop com.sun.tools.javac.Main HadoopSort.java

	jar cf hs.jar HadoopSort*.class


	time bin/hadoop jar hs.jar HadoopSort /home/input/ /home/output | tee -a cs553-spring2021-hw6t-yguptehawk21/test_logs/[LOG_FILENAME].log

The above command will execute our code and generate the output inside HDFS /home/output directory

Now we've to copy the sorted part files generated by Hadoop program to our local file system 
	
	bin/hadoop fs -cat /home/output/part* >> [SORTED_FILENAME].txt

Then we will run valsort operation on this [SORTED_FILENAME].txt (valsort procedure is given below in  the readme document)


--- Spark Sort SparkSort.java ---

Hadoop cluster is inside /exports/projects/hadoop-3.2.2/ folder of the instances

Spark is installed inside /exports/projects/spark-3.1.1-bin-hadoop3.2

Gensort Input file is inside our HDFS /home/input/

Our SparkSort.java program must be inside  /exports/projects/spark-3.1.1-bin-hadoop3.2/

We will run the following commands to execute SparkSort.java

	javac -cp jars/spark-core_2.12-3.1.1.jar:jars/scala-xml_2.12-1.2.0.jar SparkSort.java

	jar cvf SparkSort.jar SparkSort*.class

	time -p bin/spark-submit --class SparkSort --master yarn --deploy-mode cluster --driver-memory 4g --executor-memory 2g --executor-cores 1 SparkSort.jar  /home/input/   /home/output/

The above command will execute our code and generate the output inside HDFS /home/output directory

Now we've to copy the sorted part files generated by Hadoop program to our local file system 
	
	bin/hadoop fs -cat /home/output/part* >> [SORTED_FILENAME].txt

Then we will run valsort operation on this [SORTED_FILENAME].txt (valsort procedure is given below in  the readme document)


--- GENSORT ---

Datasets of 1gb , 4gb and 16gb  have been generated using gensort utility.

Gensort can be installed from this link http://www.ordinal.com/gensort.html

Generating datasets using gensort :
Use the 64 bit version of gensort to generate data

	./64/gensort -a [FILE_SIZE] [FILENAME_PATH]

Example 1gb file : ./64/gensort -a 10000000 1gb.txt

--- Shared Memory Program Mysort.cpp ----

Mysort.cpp program has to be compiled by running the Makefile

	make -f Makefile

This Makefile consists of the following command 

	g++ -std=c++11 -g -pthread quicksort.cpp Mysort.cpp minheap.cpp -o ms.out

After executing the above Makefile we will get the output object file ms.out

My program takes two arguments , the generated file name and the number of threads

	./ms.out -F [FILENAME_PATH] -t [NUM_OF_THREADS] | tee -o [LOG_FILENAME]

For 1gb and 4gb files I have implemented 2 and 4 number of threads 
And for 16gb and 64gb files I have implemented 24 and 48 number of threads 
The above command generated sorted-data at the same file location

Example : ./ms.out -F 1gb.txt -t 4

---- Linux sort implementation --- 

The linux sort command has to be executed along with some parameters like the key, buffer size , parallel number of threads and the output file location
Time command is used to keep track of the time required to executed linux sort command

	time sort [FILENAME] -k1 -S8G --parallel=[NUME_OF_THREADS] -o [OUTPUT_FILENAME] | tee -a [LOG_FILENAME]

Example : time sort 1gb.txt -k1 -S8G --parallel=2 -o sorted_data_1gb2t.txt | tee -a log1gb2t.log

--- VALSORT --
Now the above generated sorted-data files will be validated using valsort utility

	./64/valsort [FILENAME]

Example : ./64/valsort sorted-data

The above command will validate sorted data


